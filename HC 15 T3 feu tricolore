-- HC15T3 : Exception personnalisÃ©e pour feux tricolores

import Control.Exception

-- DÃ©finition des feux
data Feu = Rouge | Orange | Vert
    deriving (Show)

-- DÃ©finition de l'exception personnalisÃ©e
data FeuException = FeuInvalide String
    deriving (Show)

instance Exception FeuException

-- Conversion string -> Feu (avec exception)
parseFeu :: String -> IO Feu
parseFeu "rouge"  = return Rouge
parseFeu "orange" = return Orange
parseFeu "vert"   = return Vert
parseFeu x        = throwIO (FeuInvalide x)

-- RÃ©action de la voiture
reactToFeu :: Feu -> String
reactToFeu Rouge  = "STOP ğŸš—âœ‹"
reactToFeu Orange = "RALENTIR ğŸš—âš ï¸"
reactToFeu Vert   = "AVANCER ğŸš—ğŸ’¨"

-- Programme principal avec gestion d'exception
main :: IO ()
main = do
    putStrLn "=== SystÃ¨me de feux avec exception personnalisÃ©e ==="
    putStrLn "Entrez la couleur du feu : rouge / orange / vert"

    input <- getLine

    result <- try (parseFeu input) :: IO (Either FeuException Feu)

    case result of
        Right feu -> putStrLn (reactToFeu feu)
        Left (FeuInvalide couleur) ->
            putStrLn ("âŒ Erreur : feu invalide -> " ++ couleur)
